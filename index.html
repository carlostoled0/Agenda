<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Painel Canal Inteligente</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">

<div class="bg-white p-8 rounded shadow-md w-full max-w-md">
  <h1 class="text-2xl font-bold mb-4 text-center">Buscar Canal do YouTube</h1>

  <input id="urlInput" type="text" placeholder="https://www.youtube.com/@GranCursosOAB" class="border p-2 rounded w-full mb-4">
  <button onclick="buscarCanal()" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded">🔎 Buscar Canal</button>

  <div id="resultado" class="mt-4 text-center"></div>
</div>

<script>
const apiKey = 'AIzaSyC4Hq-5MQNh21c0-yMJq0vOrFvyJRD_bg0'; // Sua nova API Key

async function buscarCanal() {
  const input = document.getElementById('urlInput').value.trim();
  const resultado = document.getElementById('resultado');
  resultado.innerHTML = '🔄 Buscando...';

  try {
    let username = '';
    if (input.includes('@')) {
      username = input.split('@')[1];
      if (username.includes('/')) username = username.split('/')[0];
    } else {
      resultado.innerHTML = '❌ URL inválida. Cole o link do YouTube.';
      return;
    }

    // Busca via Search
    const searchUrl = `https://www.googleapis.com/youtube/v3/search?part=snippet&type=channel&q=${username}&key=${apiKey}`;
    const searchRes = await fetch(searchUrl);
    const searchData = await searchRes.json();

    if (!searchData.items || searchData.items.length === 0) {
      resultado.innerHTML = '⚠️ Canal não encontrado.';
      return;
    }

    const channelId = searchData.items[0].snippet.channelId || searchData.items[0].id.channelId;

    // Busca detalhes do canal
    const channelUrl = `https://www.googleapis.com/youtube/v3/channels?part=snippet,statistics&id=${channelId}&key=${apiKey}`;
    const channelRes = await fetch(channelUrl);
    const channelData = await channelRes.json();

    if (!channelData.items || channelData.items.length === 0) {
      resultado.innerHTML = '⚠️ Detalhes do canal não encontrados.';
      return;
    }

    const canal = channelData.items[0];
    resultado.innerHTML = `
      <div class="mt-4">
        <h2 class="text-xl font-semibold">@${canal.snippet.customUrl || canal.snippet.title}</h2>
        <p>👥 ${parseInt(canal.statistics.subscriberCount).toLocaleString()} inscritos</p>
        <p>🎥 ${parseInt(canal.statistics.videoCount).toLocaleString()} vídeos</p>
        <p>👁️ ${parseInt(canal.statistics.viewCount).toLocaleString()} visualizações</p>
      </div>
    `;
  } catch (error) {
    console.error('Erro ao buscar:', error);
    resultado.innerHTML = '❌ Erro ao buscar canal. Tente novamente.';
  }
}
</script>

</body>
</html>